<!-- Custom Title Bar Component -->
<div id="titlebar" class="titlebar">
    <!-- Left: Menu Items -->
    <div class="titlebar-left">
        <div class="menu-dropdown" id="file-menu">
            <button class="menu-btn">File</button>
            <div class="menu-content">
                <a href="#" onclick="window.electronAPI?.reload()">Reload</a>
                <div class="menu-divider"></div>
                <a href="#" onclick="window.electronAPI?.clearCache()">Clear Cache & Reset</a>
                <div class="menu-divider"></div>
                <a href="#" onclick="window.electronAPI?.quit()">Exit</a>
            </div>
        </div>
        <div class="menu-dropdown" id="view-menu">
            <button class="menu-btn">View</button>
            <div class="menu-content">
                <a href="#" onclick="toggleTheme()">Toggle Theme</a>
                <div class="menu-divider"></div>
                <a href="#" onclick="window.electronAPI?.zoomIn()">Zoom In</a>
                <a href="#" onclick="window.electronAPI?.zoomOut()">Zoom Out</a>
                <a href="#" onclick="window.electronAPI?.resetZoom()">Reset Zoom</a>
                <div class="menu-divider"></div>
                <a href="#" onclick="window.electronAPI?.toggleFullscreen()">Toggle Fullscreen</a>
            </div>
        </div>
        <div class="menu-dropdown" id="help-menu">
            <button class="menu-btn">Help</button>
            <div class="menu-content">
                <a href="#" onclick="window.electronAPI?.showAbout()">About ETTA-X</a>
                <a href="#" onclick="window.electronAPI?.toggleDevTools()">Developer Tools</a>
            </div>
        </div>
    </div>

    <!-- Center: ETTA-X Title -->
    <div class="titlebar-center">
        <span class="titlebar-title">ETTA-X</span>
    </div>

    <!-- Right: Window Controls -->
    <div class="titlebar-right">
        <button class="window-btn" id="minimize-btn" onclick="window.electronAPI?.minimize()">
            <svg width="12" height="12" viewBox="0 0 12 12">
                <rect x="2" y="5.5" width="8" height="1" fill="currentColor" />
            </svg>
        </button>
        <button class="window-btn" id="maximize-btn" onclick="window.electronAPI?.maximize()">
            <svg width="12" height="12" viewBox="0 0 12 12">
                <rect x="2" y="2" width="8" height="8" stroke="currentColor" fill="none" stroke-width="1" />
            </svg>
        </button>
        <button class="window-btn close-btn" id="close-btn" onclick="window.electronAPI?.close()">
            <svg width="12" height="12" viewBox="0 0 12 12">
                <path d="M2 2L10 10M10 2L2 10" stroke="currentColor" stroke-width="1.5" />
            </svg>
        </button>
    </div>
</div>

<style>
    /* Title Bar Styles */
    .titlebar {
        display: flex;
        align-items: center;
        height: 32px;
        background-color: #ffffff;
        border-bottom: 1px solid #e5e7eb;
        -webkit-app-region: drag;
        user-select: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 9999;
    }

    .titlebar-left {
        display: flex;
        align-items: center;
        height: 100%;
        -webkit-app-region: no-drag;
        padding-left: 8px;
    }

    .titlebar-center {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .titlebar-title {
        font-size: 13px;
        font-weight: 600;
        color: #374151;
        letter-spacing: 0.5px;
    }

    .titlebar-right {
        display: flex;
        height: 100%;
        -webkit-app-region: no-drag;
    }

    /* Menu Buttons */
    .menu-dropdown {
        position: relative;
        height: 100%;
    }

    .menu-btn {
        height: 100%;
        padding: 0 12px;
        background: transparent;
        border: none;
        color: #4b5563;
        font-size: 13px;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.15s;
    }

    .menu-btn:hover {
        background-color: rgba(0, 0, 0, 0.06);
    }

    /* Dropdown Menu */
    .menu-content {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        min-width: 180px;
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
        padding: 4px 0;
        z-index: 10000;
    }

    .menu-dropdown:hover .menu-content,
    .menu-dropdown.active .menu-content {
        display: block;
    }

    .menu-content a {
        display: block;
        padding: 8px 16px;
        color: #374151;
        text-decoration: none;
        font-size: 13px;
        transition: background-color 0.15s;
    }

    .menu-content a:hover {
        background-color: #f3f4f6;
    }

    .menu-divider {
        height: 1px;
        background: #e5e7eb;
        margin: 4px 0;
    }

    /* Window Control Buttons */
    .window-btn {
        width: 46px;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: transparent;
        border: none;
        color: #6b7280;
        cursor: pointer;
        transition: background-color 0.15s;
    }

    .window-btn:hover {
        background-color: rgba(0, 0, 0, 0.06);
    }

    .window-btn.close-btn:hover {
        background-color: #e81123;
        color: white;
    }

    /* Dark Theme */
    body.dark-theme .titlebar {
        background-color: #1e1e1e;
        border-bottom-color: #333333;
    }

    body.dark-theme .titlebar-title {
        color: #e5e5e5;
    }

    body.dark-theme .menu-btn {
        color: #cccccc;
    }

    body.dark-theme .menu-btn:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }

    body.dark-theme .menu-content {
        background: #2d2d2d;
        border-color: #404040;
    }

    body.dark-theme .menu-content a {
        color: #cccccc;
    }

    body.dark-theme .menu-content a:hover {
        background-color: #3d3d3d;
    }

    body.dark-theme .menu-divider {
        background: #404040;
    }

    body.dark-theme .window-btn {
        color: #cccccc;
    }

    body.dark-theme .window-btn:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }

    body.dark-theme .window-btn.close-btn:hover {
        background-color: #e81123;
        color: white;
    }
</style>

<script>
    // Close dropdowns when clicking outside
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.menu-dropdown')) {
            document.querySelectorAll('.menu-dropdown').forEach(d => d.classList.remove('active'));
        }
    });

    // Toggle dropdown on click
    document.querySelectorAll('.menu-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const dropdown = btn.parentElement;
            const isActive = dropdown.classList.contains('active');
            document.querySelectorAll('.menu-dropdown').forEach(d => d.classList.remove('active'));
            if (!isActive) dropdown.classList.add('active');
        });
    });
</script>